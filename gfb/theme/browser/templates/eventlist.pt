<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="iwwb.eventlist">
<body>

<metal:css fill-slot="style_slot">
  <link tal:attributes="href string:$portal_url/++resource++jquery.datatables/media/css/demo_table.css" media="screen" type="text/css" rel="stylesheet" />
  <link tal:attributes="href string:$portal_url/++resource++jquery.datatables/extras/TableTools/media/css/TableTools.css" media="screen" type="text/css" rel="stylesheet" />
  <link tal:attributes="href string:$portal_url/++resource++iwwb.eventlist/eventlist.css" media="screen" type="text/css" rel="stylesheet" />
</metal:css>

<metal:js fill-slot="javascript_head_slot">
  <script tal:attributes="src string:$portal_url/++resource++jquery.datatables/extras/TableTools/media/js/ZeroClipboard.js" type="text/javascript"></script>
  <script tal:attributes="src string:$portal_url/++resource++jquery.datatables/extras/TableTools/media/js/TableTools.js" type="text/javascript"></script>
  <script tal:attributes="src string:$portal_url/++resource++iwwb.eventlist/eventlist.js" type="text/javascript"></script>
</metal:js>

<metal:main fill-slot="main">
  <metal:main define-macro="main">

    <h1 class="documentFirstHeading" i18n:translate="">
      Search for events
    </h1>

    <form id="searchform" class="searchPage searchform-controls rowlike enableUnloadProtection kssattr-formname-eventlist">

        <div id="simplesearch">
            <ul class="search-top">
                <li>
                    <a class="selected" id="searchdatabase"
                    i18n:translate="label_eventlist_search" i18n:domain="gfb"
                    href="advanced_search">Suche in Meta-Suchmaschine des Deutschen Bildungsservers</a>
                </li>
                <li>
                    <a href="searchtipps" id="searchtipps" i18n:domain="gfb"
                    i18n:translate="label_searchtips">Search Tips</a>
                </li>
            </ul>
        </div>

        <div id="searchfields">
            <div id="searchtippstext" tal:define="tipps python:getattr(here, 'eventsearchtipps', None)">
                <span tal:replace="structure tipps/getText |string:nothing" />
            </div>

            <div id="searchcontrols">
                <div id="eventlist-form">

                <!-- For later usage: A widget that displays Risk Factors -->
                <!--div class="search_filters indent3">
                      <div class="dynatree-atwidget dynatree-custom search_deactivatable"
                          tal:attributes="class python:request.get('getCategoryIndependent', '0')=='1'
                           and 'dynatree-atwidget dynatree-custom search_deactivatable disabled'
                           or 'dynatree-atwidget dynatree-custom search_deactivatable'">
                       <dt href="#" id="button_riskfactors" class="toggleButton">
                         <a i18n:domain="RiskAssessmentLink" i18n:translate="ra_riskfactors_label"
                           class="fakeLink">Gef√§hrdungsart</a>
                        </dt>
                        <div class="flatlist_container">
                          <div class="flatlist-template">
                            <div class="flatlist-item"
                                key="{{ key }}"><img src="ico_check_red.gif"
                                 i18n:attributes="title" i18n:domain="gfb"
                                title="label_delete_selection" alt="delete" class="delete">&nbsp;{{ title }}</div>
                          </div>
                        </div>
                       <div id="widget_riskfactors" class="closed_widget">
                        <div class="dynatree_filter">
                          <input type="text" class="filter" />
                        </div>
                        <div class="collective-dynatree-tree">You need to activate JavaScript for the search to work.</div>
                        <div class="dynatree_ajax_vocabulary hiddenStructure"
                             tal:content="string:${portal_url}/vdex_as_json?vdex=RiskFactors">Some URL</div>
                        <div class="dynatree_parameters hiddenStructure">selectMode,2/minExpandLevel,1/leafsOnly,True/rootVisible,False/autoCollapse,False/sparse,True/flatlist,True/title,Multiple_all/checkbox,True</div>
                        <input type="hidden" size="120" value="" id="RiskFactors" name="RiskFactors2" class="hiddeninput selected"
                               tal:attributes="value request/RiskFactors2 | nothing" />
                        <div class="customhiddeninput"></div>
                        <div class="ui_controls">
                          <div class="sparse">Sparse</div>
                        </div>
                      </div>
                     </div>
                 </div-->

                 <span tal:replace="structure view/contents" />

                </div>
            </div>
        </div>

        <div class="visualClear"></div>

        <h2 i18n:translate="">
        Results
        </h2>

        <tal:results define="events view/options/events|nothing;
            toLocalizedTime nocall:context/@@plone/toLocalizedTime">
            <!-- The id here here must be 'example' because we use dataTable's demo CSS -->
            <table id="example" class="display"
                tal:condition="events">
                <thead>
                    <tr>
                        <th i18n:translate="" title="Sort by title" i18n:attributes="title sort_by_title">Title</th>
                        <th i18n:translate="" title="Sort by type" i18n:attributes="title sort_by_type">Type</th>
                        <th i18n:translate="" title="Sort by city" i18n:attributes="title sort_by_city">City</th>
                        <th i18n:translate="" title="Sort by zip" i18n:attributes="title sort_by_zip">Zip</th>
                        <th i18n:translate="" title="Sort by start date" i18n:attributes="title sort_by_start_date">Start date</th>
                        <th i18n:translate="" title="Sort by training supplier" i18n:attributes="title sort_by_training_supplier">Training Supplier</th>
                    </tr>
                </thead>
            <tbody>
                <tr tal:repeat="event events">
                <td>
                    <a tal:content="event/Title"
                    tal:attributes="href event/ReferenceUrl|nothing">
                    Title
                    </a>
                </td>
                <td tal:content="python: view.event_type(event.Type)">Event type</td>
                <td tal:content="event/City|nothing">City</td>
                <td tal:content="event/Zip|nothing">Zip code</td>
                <td tal:define="startTime event/StartTime|nothing"
                    tal:content="python:startTime and toLocalizedTime(startTime) or ''">Start date</td>
                <td>
                    <a class="training-supplier" rel="#overlay"
                    tal:content="event/TrainingSupplier|nothing"
                    tal:attributes="href event/TrainingSupplierUrl|nothing">
                    Training Supplier
                    </a>
                </td>
                </tr>
            </tbody>
            </table>
            <p tal:condition="python: not events" i18n:translate="">No events found.</p>
        </tal:results>

        <!-- overlay -->
        <div class="overlay overlay-ajax" id="overlay">
        <div class="close"><span>Close</span></div>
        <div class="pb-ajax"><div class="content-wrap"></div></div>
        </div>

  </form>
  </metal:main>
</metal:main>

</body>
</html>
